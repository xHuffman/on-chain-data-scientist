
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>🛠 ETH 归档节点-6 安全通信 TSL · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="07.html" />
    
    
    <link rel="prev" href="05.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">预习</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    👋 简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../overview/what-we-do.html">
            
                <a href="../../overview/what-we-do.html">
            
                    
                    💡 关于我们
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../overview/our-features.html">
            
                <a href="../../overview/our-features.html">
            
                    
                    ✨ 我们的特性
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">模块一、基础设施</li>
        
        
    

    
        
        <li class="header">1.1 链上数据</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="eth-gui-dang-jie-dian.html">
            
                <a href="eth-gui-dang-jie-dian.html">
            
                    
                    🛠 1.1 5分钟搭建 ETH 归档节点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="00.html">
            
                <a href="00.html">
            
                    
                    🛠 ETH 归档节点-0：如何将 AWS 数据下载到本地
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="00.html">
            
                <a href="00.html">
            
                    
                    🛠 ETH 归档节点-1：部署 ETH RPC -改写 AWS执行脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="02.html">
            
                <a href="02.html">
            
                    
                    🛠 ETH 归档节点-2：部署 ETH RPC -如何将 AWS 数据下载到本地
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="03.html">
            
                <a href="03.html">
            
                    
                    🛠 ETH 归档节点-3：build_archive_node 解读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="04.html">
            
                <a href="04.html">
            
                    
                    🛠 ETH 归档节点-4：网络问题解答
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="05.html">
            
                <a href="05.html">
            
                    
                    🛠 ETH 归档节点-5 Erigon/Lighthouse/RPCdame 节点启动
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.8" data-path="06.html">
            
                <a href="06.html">
            
                    
                    🛠 ETH 归档节点-6 安全通信 TSL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="07.html">
            
                <a href="07.html">
            
                    
                    🛠 ETH 归档节点-7 安全攻防
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="08.html">
            
                <a href="08.html">
            
                    
                    🛠 ETH 归档节点-8 erigon与 Lighthouse  交易api
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="eth-gui-dang-jie-dian.html">
            
                <a href="eth-gui-dang-jie-dian.html">
            
                    
                    🧑 1.2 社交舆情数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="eth-gui-dang-jie-dian.html">
            
                <a href="eth-gui-dang-jie-dian.html">
            
                    
                    💰 1.3 交易所数据
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">模块二、数据处理&算法</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../p2-shu-ju-chu-li-suan-fa/making-a-post.html">
            
                <a href="../../p2-shu-ju-chu-li-suan-fa/making-a-post.html">
            
                    
                    💽 2.1 分布式数据库Doris
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../../p2-shu-ju-chu-li-suan-fa/making-a-post.html">
            
                <a href="../../p2-shu-ju-chu-li-suan-fa/making-a-post.html">
            
                    
                    🌟 2.2 Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../p2-shu-ju-chu-li-suan-fa/making-a-post.html">
            
                <a href="../../p2-shu-ju-chu-li-suan-fa/making-a-post.html">
            
                    
                    🛸 2.3 Flink
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">模块三、数据可视化</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../p3-shu-ju-ke-shi-hua/for-beginners.md">
            
                <span>
            
                    
                    🎨  3.1 入门教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../p3-shu-ju-ke-shi-hua/for-developers.html">
            
                <a href="../../p3-shu-ju-ke-shi-hua/for-developers.html">
            
                    
                    🖥  3.2 中级教程
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">模块四、实战篇</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="eth-gui-dang-jie-dian.html">
            
                <a href="eth-gui-dang-jie-dian.html">
            
                    
                    📪 4.1 XEN 项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="eth-gui-dang-jie-dian.html">
            
                <a href="eth-gui-dang-jie-dian.html">
            
                    
                    📪 4.2 4年1000倍
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >🛠 ETH 归档节点-6 安全通信 TSL</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>ETH &#x5F52;&#x6863;&#x8282;&#x70B9;-6 &#x5B89;&#x5168;&#x901A;&#x4FE1; TSL</p>
<p>&#x73B0;&#x5728;&#x7684;&#x95EE;&#x9898;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;</p>
<p>&#x9700;&#x8981;&#x5C06; erigon &#x6570;&#x636E;&#x540C;&#x6B65;&#x5230;&#x6700;&#x65B0;&#x7684;&#x5757;</p>
<p>&#x4F60;&#x731C;&#x6D4B;&#x7684;&#x539F;&#x56E0;&#x662F; erigon &#x4E0E; rpcdaemon&#x4E4B;&#x95F4;&#x901A;&#x4FE1;&#x7684;&#x6CA1;&#x6709;&#x4FE1;&#x4EFB;&#x3002;</p>
<p>&#x4E00;&#x3001;&#x521B;&#x5EFA; TSL &#x5B89;&#x5168;&#x901A;&#x4FE1;</p>
<p>&#x5177;&#x4F53;&#x7684;&#x547D;&#x4EE4;&#x5982;&#x4E0B;</p>
<p>&#x521B;&#x5EFA; CA &#x79D8;&#x94A5;&#x5BF9;
openssl ecparam -name prime256v1 -genkey -noout -out CA-key.pem
&#x6839;&#x636E; &#x81EA;&#x7B7E;&#x540D;&#x8BC1;&#x4E66;
openssl req -x509 -new -nodes -key CA-key.pem -sha256 -days 3650 -out CA-cert.pem</p>
<p>&#x521B;&#x5EFA; erigon &#x79D8;&#x94A5;&#x5BF9;
openssl ecparam -name prime256v1 -genkey -noout -out erigon-key.pem
&#x521B;&#x5EFA; RPC &#x79D8;&#x94A5;&#x5BF9;
openssl ecparam -name prime256v1 -genkey -noout -out RPC-key.pem</p>
<p>&#x4E0B;&#x5217;&#x6E05;&#x55AE;&#x89E3;&#x91CB;&#x4E86;&#x6B64;&#x547D;&#x4EE4;&#x7684;&#x90E8;&#x4EFD;&#x53C3;&#x6578;&#xFF0C;&#x82E5;&#x60A8;&#x6709;&#x8208;&#x8DA3;&#x77AD;&#x89E3;&#x6240;&#x6709;&#x53C3;&#x6578;&#xFF0C;&#x8ACB;&#x53C3;&#x8003; OpenSSL &#x5B98;&#x65B9;&#x6587;&#x4EF6; &#x3002;
-newkey rsa:2048&#xFF1A; &#x7522;&#x751F; CSR &#x8207;&#x4E00;&#x500B; 2048 &#x4F4D;&#x5143;&#x7684; RSA &#x5BC6;&#x9470;&#xFF1B;&#x5982;&#x679C;&#x60A8;&#x7684;&#x6191;&#x8B49;&#x662F;&#x8981;&#x5B89;&#x88DD;&#x5728; Gandi Simple Hosting &#x7DB2;&#x9801;&#x4EE3;&#x7BA1;&#x4E3B;&#x6A5F;&#x4E0A;&#xFF0C;&#x8ACB;&#x52D9;&#x5FC5;&#x4F7F;&#x7528; 2048 &#x4F4D;&#x5143;&#x7684;&#x5BC6;&#x9470;&#x3002;
-sha256&#xFF1A;&#x4F7F;&#x7528; SHA-2&#xFF0C;SHA256 &#x96DC;&#x6E4A;&#x6F14;&#x7B97;&#x6CD5;&#xFF08;hash algorithm&#xFF09;&#x3002;&#x5982;&#x679C;&#x60A8;&#x4F7F;&#x7528;&#x73FE;&#x5DF2;&#x68C4;&#x7528;&#x7684; SHA1 &#x6191;&#x8B49;&#xFF0C;Sectigo &#x5C07;&#x6703;&#x81EA;&#x52D5;&#x70BA;&#x60A8;&#x8F49;&#x63DB;&#x6210; SHA2 &#x6191;&#x8B49;&#x3002;
-keyout myserver.key&#xFF1A;&#x5C07;&#x5BC6;&#x9470;&#x5132;&#x5B58;&#x5728;&#x7576;&#x4E0B;&#x76EE;&#x9304;&#x7684;&#x300C;myserver.key&#x300D;&#x6A94;&#x6848;&#x4E2D;&#x3002;
-out server.csr&#xFF1A;&#x5C07; CSR &#x6A94;&#x6848;&#x5132;&#x5B58;&#x5728;&#x7576;&#x4E0B;&#x76EE;&#x9304;&#x7684;&#x300C;server.csr&#x300D;&#x6A94;&#x6848;&#x4E2D;&#x3002;</p>
<p>&#x521B;&#x5EFA;erigon&#x8BC1;&#x4E66;&#x7B7E;&#x540D;&#x8BF7;&#x6C42;
openssl req -new -key erigon-key.pem -out erigon.csr</p>
<p>&#x5728;&#x60A8;&#x57F7;&#x884C;&#x547D;&#x4EE4;&#x4E4B;&#x5F8C;&#xFF0C;&#x7CFB;&#x7D71;&#x6703;&#x63D0;&#x793A;&#x60A8;&#x8F38;&#x5165;&#x500B;&#x4EBA;&#x8CC7;&#x6599;&#xFF0C;&#x8A72;&#x8CC7;&#x6599;&#x662F;&#x6191;&#x8B49;&#x9A57;&#x8B49;&#x55AE;&#x4F4D;&#x5728;&#x9A57;&#x8B49;&#x6191;&#x8B49;&#x6642;&#x6703;&#x67E5;&#x95B1;&#x7684;&#x500B;&#x4EBA;&#x8CC7;&#x6599;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#xFF1A;
Country name&#xFF1A;&#x4E8C;&#x5B57;&#x5143;&#x570B;&#x78BC;
State or Province Name&#xFF1A;&#x5DDE;&#x6216;&#x7701;&#x7684;&#x540D;&#x7A31;&#xFF0C;&#x8ACB;&#x52FF;&#x7528;&#x7E2E;&#x5BEB;
Locality Name&#xFF1A;&#x57CE;&#x5E02;&#x6216;&#x9109;&#x93AE;&#x7684;&#x540D;&#x7A31;
Organization Name&#xFF1A;&#x60A8;&#x7D44;&#x7E54;&#xFF08;&#x516C;&#x53F8;&#xFF09;&#x7684;&#x82F1;&#x6587;&#x540D;&#x7A31;&#xFF1B;&#x6B64;&#x6B04;&#x4F4D;&#x5728;&#x7533;&#x8ACB; &#x6A19;&#x6E96;&#x578B; SSL &#x6191;&#x8B49; &#x6642;&#x70BA;&#x975E;&#x5FC5;&#x586B;&#xFF0C;&#x4F46;&#x662F;&#x82E5;&#x70BA;&#x7533;&#x8ACB; &#x9032;&#x968E;&#x578B; &#x8207; &#x4F01;&#x696D;&#x578B; SSL &#x6191;&#x8B49;&#x5247;&#x70BA;&#x5FC5;&#x586B;&#x6B04;&#x4F4D;
Organization Unit Name&#xFF1A;&#x60A8;&#x7684;&#x90E8;&#x9580;&#x540D;&#x7A31;&#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x8CC7;&#x8A0A;&#x90E8;&#x9580;&#xFF09;
Common Name&#xFF1A;&#x60A8;&#x8981;&#x4FDD;&#x8B77;&#x7684;&#x7DB2;&#x57DF;&#x540D;&#x7A31;&#xFF1B;&#x8A73;&#x898B;&#x672C;&#x9801;&#x5148;&#x524D;&#x7684;&#x6BB5;&#x843D;
Email Address&#xFF1A;&#x60A8;&#x7684;&#x96FB;&#x5B50;&#x4FE1;&#x7BB1;&#x4F4D;&#x5740;&#xFF1B;&#x6B64;&#x6B04;&#x4F4D;&#x70BA;&#x975E;&#x5FC5;&#x586B;&#xFF0C;&#x4F46;&#x662F;&#x5EFA;&#x8B70;&#x586B;&#x5BEB;
A challenge password&#xFF1A;&#x70BA;&#x6975;&#x5C11;&#x4F7F;&#x7528;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5EFA;&#x8B70;&#x60A8;&#x4E0D;&#x7528;&#x586B;&#x5BEB;&#xFF0C;&#x7559;&#x767D;&#x5373;&#x53EF;
An optional company name: &#x5EFA;&#x8B70;&#x4E0D;&#x7528;&#x586B;&#x5BEB;&#xFF0C;&#x7559;&#x767D;&#x5373;&#x53EF;
&#x5728;&#x60A8;&#x5B8C;&#x6210;&#x6307;&#x4EE4;&#x4E4B;&#x5F8C;&#xFF0C;&#x7CFB;&#x7D71;&#x6703;&#x540C;&#x6642;&#x7522;&#x751F;&#x5169;&#x500B;&#x6A94;&#x6848;&#xFF1A;&#x4E00;&#x822C;&#x7684; .csr &#x6A94;&#x3001;&#x79C1;&#x9470; .key &#x6A94;&#xFF0C;&#x5132;&#x5B58;&#x65BC;&#x60A8;&#x7684;&#x96FB;&#x8166;&#x6216;&#x4F3A;&#x670D;&#x5668;&#x4E0A;&#xFF0C;&#x56E0;&#x6B64;&#x53EA;&#x6709;&#x60A8;&#x81EA;&#x5DF1;&#x53EF;&#x4EE5;&#x5B58;&#x53D6;&#x6B64;&#x300C;.key&#x300D;&#x6A94;&#x3002;</p>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x8BC1;&#x4E66;&#x7B7E;&#x540D;&#x8BF7;&#x6C42;&#x4E2D;&#xFF0C;&#x4EA7;&#x751F;&#x8BC1;&#x4E66;(&#x7531;CA&#x7B7E;&#x7F72;)
openssl x509 -req -in erigon.csr -CA CA-cert.pem -CAkey CA-key.pem -CAcreateserial -out erigon.crt -days 3650 -sha256</p>
<p>&#x521B;&#x5EFA;rpc&#x8BC1;&#x4E66;&#x7B7E;&#x540D;&#x8BF7;&#x6C42;
openssl req -new -key RPC-key.pem -out RPC.csr</p>
<p>&#x4ECE;&#x4E0A;&#x9762;&#x7684;&#x8BC1;&#x4E66;&#x7B7E;&#x540D;&#x8BF7;&#x6C42;&#x4E2D;&#xFF0C;&#x4EA7;&#x751F;&#x8BC1;&#x4E66;(&#x7531;CA&#x7B7E;&#x7F72;)
openssl x509 -req -in RPC.csr -CA CA-cert.pem -CAkey CA-key.pem -CAcreateserial -out RPC.crt -days 3650 -sha256</p>
<p>/erigon/start_erigon_service.sh</p>
<p>/lighthouse/start_lighthouse_beacon.sh</p>
<p>ssh &#x548C; tsl&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;</p>
<p>TLS 1.0&#x901A;&#x5E38;&#x88AB;&#x6807;&#x793A;&#x4E3A;SSL 3.1&#xFF0C;TLS 1.1&#x4E3A;SSL 3.2&#xFF0C;TLS 1.2&#x4E3A;SSL 3.3&#x3002;</p>
<p>&#xFFFC;</p>
<p>&#xFFFC;</p>
<p>&#x4E8C;&#x3001;&#x642D;&#x5EFA; nginx </p>
<p>$ sudo apt install 
$ sudo nmap -sT -O localhost</p>
<p>Starting Nmap 7.80 ( <a href="https://nmap.org" target="_blank">https://nmap.org</a> ) at 2022-11-14 13:42 CST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000064s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
111/tcp  open  rpcbind
631/tcp  open  ipp
9000/tcp open  cslistener
9090/tcp open  zeus-admin
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.32
OS details: Linux 2.6.32
Network Distance: 0 hops</p>
<p>$ sudo netstat -tulpn | grep LISTEN</p>
<p>&#x4E09;&#x3001;&#x9632;&#x706B;&#x5899;&#x8BBE;&#x7F6E;</p>
<p>3.1 &#x67E5;&#x770B;&#x9632;&#x706B;&#x5899;
sudo iptables --list</p>
<p>3.2 &#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;</p>
<h1 id="&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#x8BBE;&#x7F6E;&#x4E3A;accept&#xFF0C;&#x5426;&#x5219;&#x540E;&#x7EED;&#x64CD;&#x4F5C;&#x4F1A;&#x5BFC;&#x81F4;&#x8FDE;&#x63A5;&#x65AD;&#x5F00;&#xFF0C;&#x65E0;&#x6CD5;&#x518D;&#x6B21;&#x8FDE;&#x63A5;">&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#x8BBE;&#x7F6E;&#x4E3A;ACCEPT&#xFF0C;&#x5426;&#x5219;&#x540E;&#x7EED;&#x64CD;&#x4F5C;&#x4F1A;&#x5BFC;&#x81F4;&#x8FDE;&#x63A5;&#x65AD;&#x5F00;&#xFF0C;&#x65E0;&#x6CD5;&#x518D;&#x6B21;&#x8FDE;&#x63A5;</h1>
<p>sudo iptables -P INPUT ACCEPT
sudo iptables -P FORWARD ACCEPT
sudo iptables -P OUTPUT ACCEPT
sudo iptables -t nat -P PREROUTING ACCEPT
sudo iptables -t nat -P POSTROUTING ACCEPT
sudo iptables -t nat -P OUTPUT ACCEPT</p>
<h1 id="&#x6E05;&#x7A7A;&#x6240;&#x6709;&#x89C4;&#x5219;">&#x6E05;&#x7A7A;&#x6240;&#x6709;&#x89C4;&#x5219;</h1>
<p>sudo iptables -F
sudo iptables -t nat -F</p>
<h1 id="&#x5220;&#x9664;&#x6240;&#x6709;&#x975E;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x7684;&#x94FE;">&#x5220;&#x9664;&#x6240;&#x6709;&#x975E;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x7684;&#x94FE;</h1>
<p>sudo iptables -X
sudo iptables -t nat -X</p>
<p>3.3 &#x4FDD;&#x5B58;
sudo iptables-save</p>
<p>&#x5217;&#x51FA;&#x89C4;&#x5219; 
sudo iptables -L
&#x5220;&#x9664;&#x89C4;&#x5219;
sudo iptables -F</p>
<p>sudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT</p>
<p>&#x6DFB;&#x52A0;&#x5141;&#x8BB8; 22,80 &#x7AEF;&#x53E3;
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT</p>
<p>&#x5217;&#x51FA;&#x8BBE;&#x7F6E;&#x540E;&#x7684;&#x672C;&#x5730;&#x89C4;&#x5219;
sudo iptables -nvL</p>
<p> 6817  355K ufw-reject-input  all  --  <em>      </em>       0.0.0.0/0            0.0.0.0/0
 6817  355K ufw-track-input  all  --  <em>      </em>       0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     tcp  --  <em>      </em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:80
    0     0 ACCEPT     tcp  --  eth0   <em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:20
    0     0 ACCEPT     tcp  --  eth0   </em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:21
    0     0 ACCEPT     tcp  --  eth0   <em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:22
    0     0 ACCEPT     tcp  --  eth0   </em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:23
    0     0 ACCEPT     tcp  --  eth0   <em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:25
    0     0 ACCEPT     tcp  --  eth0   </em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:53
    0     0 ACCEPT     udp  --  eth0   <em>       0.0.0.0/0            0.0.0.0/0            udp dpt:53
    0     0 ACCEPT     tcp  --  eth0   </em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:110
    0     0 ACCEPT     tcp  --  eth0   <em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:113
    0     0 ACCEPT     all  --  eth0   </em>       0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
    0     0 DROP       all  --  eth0   <em>       0.0.0.0/0            0.0.0.0/0            state INVALID,NEW
    0     0 ACCEPT     tcp  --  </em>      <em>       0.0.0.0/0            0.0.0.0/0            tcp dpt:80
    0     0 ACCEPT     tcp  --  </em>      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:8080</p>
<p>&#x4E22;&#x5F03;&#x6240;&#x6709;&#x548C;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x914D;&#x7F6E;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x5305;
sudo iptables -P INPUT DROP</p>
<p>&#x5C06;&#x89C4;&#x5219;&#x53D8;&#x6210;&#x6C38;&#x4E45;&#x7684;&#x89C4;&#x5219;
sudo apt-get install iptables-persistent
sudo netfilter-persistent save
sudo netfilter-persistent reload</p>
<p>&#x7B80;&#x5355;&#x7684;&#x8BF4;&#x4E00;&#x8BF4; netFilter&#x548C;iptabes&#x548C;ufw&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;</p>
<p>netFilter&#x662F; linux&#x5185;&#x6838;&#x5BF9;&#x4E8E;&#x6570;&#x636E;&#x5305;&#x7684;&#x8FC7;&#x6EE4;&#x5668;
iptabes&#x63D0;&#x4F9B;&#x4E86;&#x547D;&#x4EE4;&#x96C6;&#x64CD;&#x4F5C;netFilter
ufw &#x63D0;&#x4F9B;&#x4E86;&#x7528;&#x6237;&#x53CB;&#x597D;&#x7684;&#x754C;&#x9762;&#xFF0C;&#x7528;&#x4E8E;&#x64CD;&#x4F5C;iptabes&#x3002;</p>
<p>The Linux kernel in Ubuntu provides a packet filtering system called netfilter, and the traditional interface for manipulating netfilter are the iptables suite of commands. iptables provide a complete firewall solution that is both highly configurable and highly flexible.
Ubuntu&#x4E2D;&#x7684;Linux&#x5185;&#x6838;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;netFilter&#x7684;&#x6570;&#x636E;&#x5305;&#x8FC7;&#x6EE4;&#x7CFB;&#x7EDF;&#xFF0C;&#x7528;&#x4E8E;&#x64CD;&#x4F5C;netFilter&#x7684;&#x4F20;&#x7EDF;&#x754C;&#x9762;&#x662F;iptabLes&#x547D;&#x4EE4;&#x96C6;&#x3002;IPTABLE&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x5957;&#x5B8C;&#x6574;&#x7684;&#x9632;&#x706B;&#x5899;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x8BE5;&#x65B9;&#x6848;&#x65E2;&#x9AD8;&#x5EA6;&#x53EF;&#x914D;&#x7F6E;&#xFF0C;&#x53C8;&#x9AD8;&#x5EA6;&#x7075;&#x6D3B;&#x3002;</p>
<p>Becoming proficient in iptables takes time, and getting started with netfilter firewalling using only iptables can 
be a daunting task. As a result, many frontends for iptables have been created over the years, each trying to achieve a different result and targeting a different audience.
&#x7CBE;&#x901A;iptabes&#x9700;&#x8981;&#x65F6;&#x95F4;&#xFF0C;&#x800C;&#x5F00;&#x59CB;&#x4F7F;&#x7528;&#x4EC5;&#x4F7F;&#x7528;iptabes&#x7684;netfilter&#x9632;&#x706B;&#x5899;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x9879;&#x8270;&#x5DE8;&#x7684;&#x4EFB;&#x52A1;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x591A;&#x5E74;&#x6765;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x8BB8;&#x591A;IPTABLE&#x524D;&#x7AEF;&#xFF0C;&#x6BCF;&#x4E2A;&#x524D;&#x7AEF;&#x90FD;&#x8BD5;&#x56FE;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x5E76;&#x9488;&#x5BF9;&#x4E0D;&#x540C;&#x7684;&#x53D7;&#x4F17;&#x3002;</p>
<p>The Uncomplicated Firewall (ufw) is a frontend for iptables and is particularly well-suited for host-based firewalls. ufw provides a framework for managing netfilter, as well as a command-line interface for manipulating the firewall. ufw aims to provide an easy to use interface for people unfamiliar with firewall concepts, while at the same time simplifies complicated iptables commands to help an administrator who knows what he or she is doing. ufw is an upstream for other distributions and graphical frontends.
&#x7B80;&#x5355;&#x9632;&#x706B;&#x5899;(UFW)&#x662F;IPTABLE&#x7684;&#x524D;&#x7AEF;&#xFF0C;&#x7279;&#x522B;&#x9002;&#x5408;&#x57FA;&#x4E8E;&#x4E3B;&#x673A;&#x7684;&#x9632;&#x706B;&#x5899;&#x3002;UFW&#x63D0;&#x4F9B;&#x4E86;&#x7528;&#x4E8E;&#x7BA1;&#x7406;NetFilter&#x7684;&#x6846;&#x67B6;&#xFF0C;&#x4EE5;&#x53CA;&#x7528;&#x4E8E;&#x64CD;&#x4F5C;&#x9632;&#x706B;&#x5899;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x754C;&#x9762;&#x3002;UFW&#x65E8;&#x5728;&#x4E3A;&#x4E0D;&#x719F;&#x6089;&#x9632;&#x706B;&#x5899;&#x6982;&#x5FF5;&#x7684;&#x4EBA;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x6613;&#x4E8E;&#x4F7F;&#x7528;&#x7684;&#x754C;&#x9762;&#xFF0C;&#x540C;&#x65F6;&#x7B80;&#x5316;&#x590D;&#x6742;&#x7684;iptable&#x547D;&#x4EE4;&#xFF0C;&#x4EE5;&#x5E2E;&#x52A9;&#x77E5;&#x9053;&#x81EA;&#x5DF1;&#x5728;&#x505A;&#x4EC0;&#x4E48;&#x7684;&#x7BA1;&#x7406;&#x5458;&#x3002;UFW&#x662F;&#x5176;&#x4ED6;&#x5206;&#x5E03;&#x548C;&#x56FE;&#x5F62;&#x524D;&#x7AEF;&#x7684;&#x4E0A;&#x6E38;&#x3002;</p>
<p>&#x56DB;&#x3001;&#x65E5;&#x5FD7;</p>
<p>&#x6388;&#x6743;&#x65E5;&#x5FD7;</p>
<p>/var/log/auth.log</p>
<p>/var/log/syslog</p>
<p>&#x5B88;&#x62A4;&#x7A0B;&#x5E8F;&#x65E5;&#x5FD7;
/var/log/daemon.log</p>
<p>/var/log/debug</p>
<p>&#x4E09;&#x3001;Q&amp;A</p>
<p>3.1 &#x901A;&#x8FC7; 127.0.0.1 &#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#xFF0C;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#x516C;&#x7F51; IP &#x8BBF;&#x95EE;&#x3002;</p>
<p>$ iptables -A INPUT -p tcp --dport 80 -j ACCEPT</p>
<p>$ curl -4 icanhazip.com
117.62.117.83</p>
<p>&#x67E5;&#x770B;iptables&#x7B56;&#x7565;&#xFF1A;</p>
<h1 id="sudo-iptables--l">sudo iptables -L</h1>
<h1 id="sudo-ufw-status">sudo ufw status</h1>
<p>sudo ufw disable
sudo ufw enable</p>
<h1 id="iptables-apply">iptables-apply</h1>
<p>&#x56DB;&#x3001;&#x9644;&#x4EF6;</p>
<p><a href="https://github.com/ledgerwatch/erigon/blob/devel/cmd/rpcdaemon/README.md#securing-the-communication-between-rpc-daemon-and-erigon-instance-via-tls-and-authentication" target="_blank">https://github.com/ledgerwatch/erigon/blob/devel/cmd/rpcdaemon/README.md#securing-the-communication-between-rpc-daemon-and-erigon-instance-via-tls-and-authentication</a></p>
<p>ssl/tls &#x534F;&#x8BAE;&#x8FD0;&#x884C;&#x673A;&#x5236;&#x7684;&#x6982;&#x8FF0;
<a href="https://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank">https://www.ruanyifeng.com/blog/2014/02/ssl_tls.html</a></p>
<p><a href="https://docs.gandi.net/zh-hant/ssl/common_operations/csr.html" target="_blank">https://docs.gandi.net/zh-hant/ssl/common_operations/csr.html</a></p>
<p><a href="https://letsencrypt.org/" target="_blank">https://letsencrypt.org/</a></p>
<p>&#x4F7F;&#x7528; cerbot &#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x514D;&#x8D39;&#x7684; https&#x8BC1;&#x4E66;
<a href="https://certbot.eff.org/instructions?ws=nginx&amp;os=ubuntufocal" target="_blank">https://certbot.eff.org/instructions?ws=nginx&amp;os=ubuntufocal</a></p>
<p>ubuntu 22.04&#x4E0A;&#x7684;&#x64CD;&#x4F5C;&#x624B;&#x518C;&#x3002;
<a href="https://manpages.ubuntu.com/manpages/jammy/en/man8/ufw.8.html" target="_blank">https://manpages.ubuntu.com/manpages/jammy/en/man8/ufw.8.html</a></p>
<p>ubuntu&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;
<a href="https://ubuntu.com/tutorials/viewing-and-monitoring-log-files#2-log-files-locations" target="_blank">https://ubuntu.com/tutorials/viewing-and-monitoring-log-files#2-log-files-locations</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="05.html" class="navigation navigation-prev " aria-label="Previous page: 🛠 ETH 归档节点-5 Erigon/Lighthouse/RPCdame 节点启动">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="07.html" class="navigation navigation-next " aria-label="Next page: 🛠 ETH 归档节点-7 安全攻防">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"🛠 ETH 归档节点-6 安全通信 TSL","level":"3.8","depth":1,"next":{"title":"🛠 ETH 归档节点-7 安全攻防","level":"3.9","depth":1,"path":"p1-ji-chu-she-shi/lian-shang-shu-ju/07.md","ref":"p1-ji-chu-she-shi/lian-shang-shu-ju/07.md","articles":[]},"previous":{"title":"🛠 ETH 归档节点-5 Erigon/Lighthouse/RPCdame 节点启动","level":"3.7","depth":1,"path":"p1-ji-chu-she-shi/lian-shang-shu-ju/05.md","ref":"p1-ji-chu-she-shi/lian-shang-shu-ju/05.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"p1-ji-chu-she-shi/lian-shang-shu-ju/06.md","mtime":"2022-11-23T10:24:10.347Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-11-24T01:56:55.371Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

